<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Visualización de Feedback — M3</title>

  <!-- Estilos M3 -->
  <link rel="stylesheet" href="css/visualizacion_feedback.css" />

  <!-- jsPDF + html2canvas (externos, sin inline) -->
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"
  crossorigin="anonymous">
</script>

<script
  src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"
  crossorigin="anonymous">
</script>



</head>
<body>
  <div class="m3-card main-container">
    <h1 class="m3-title">Visualización de Feedback</h1>

    <!-- BANNER DE ACCESO -->
    <div id="accessWarning" class="m3-access-warning" style="display:none;">
      No tienes permisos para visualizar los feedbacks. Solo administradores y supervisores pueden acceder.
    </div>

    <!-- FILTROS -->
    <section class="m3-section" id="filtersSection" style="display:none;">
      <label class="m3-label" for="filtroAsesor">Filtrar por asesor</label>
      <select id="filtroAsesor" class="m3-select">
        <option value="">— Selecciona un asesor —</option>
      </select>

      <label class="m3-label" for="filtroRegistrado">Filtrar por quién registró</label>
      <select id="filtroRegistrado" class="m3-select">
        <option value="">— Todos —</option>
        <option value="Alex Paolo Nuñez Sulca - Líder de Calidad y Formación">
          Alex Paolo Nuñez Sulca - Líder de Calidad y Formación
        </option>
        <option value="César Alonso Torres Montes - Supervisor">
          César Alonso Torres Montes - Supervisor
        </option>
        <option value="Karen Vanessa Vital Cordova - Líder de Operaciones">
          Karen Vanessa Vital Cordova - Líder de Operaciones
        </option>
      </select>
    </section>

    <!-- TABLA (SIN COLUMNA ID) -->
    <section class="m3-section" id="tableSection" style="display:none;">
      <table id="tablaFeedback" class="m3-table">
        <thead>
          <tr>
            <th>Fecha</th>
            <th>Nota</th>
            <th>Estado</th>
            <th>Registrado por</th>
            <th>Acción</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div id="tablaVaciaMsg" class="m3-empty-state" style="display:none">
        No hay registros para este filtro.
      </div>
    </section>

    <!-- DETALLE -->
    <section id="detailBox" class="m3-detail-card" style="display:none;">
      <header class="detail-header">
        <div>
          <h2 id="tituloRetro" class="detail-title">RETROALIMENTACIÓN</h2>
          <p id="subTituloEstado" class="detail-subtitle"></p>
        </div>
        <!-- LOGO -->
        <img
          class="logo"
          src="https://firebasestorage.googleapis.com/v0/b/feedback-app-ac30e.firebasestorage.app/o/firmas%2FImagen1.png?alt=media"
          alt="Logo"
        />
      </header>

      <!-- CONTENIDO GENERADO DINÁMICAMENTE -->
      <div id="detailContent"></div>

      <div class="detail-actions">
        <button id="pdfBtn" class="m3-btn primary" type="button">
          Exportar PDF
        </button>
      </div>
    </section>
  </div>
<!-- MODAL PDF -->
<div id="pdfModal" class="pdf-modal" style="display:none;">
  <div class="pdf-modal-backdrop"></div>

  <div class="pdf-modal-content">
    <div class="pdf-modal-header">
      <h3>Vista previa del PDF</h3>
      <button id="pdfModalClose" type="button">✖</button>
    </div>

    <iframe
      id="pdfIframe"
      style="width:100%; height:80vh; border:none;"
    ></iframe>
  </div>
</div>

  <!-- JS principal (MÓDULO) -->
  <script type="module" src="js/visualizacion_feedback.js"></script>
</body>
</html>




