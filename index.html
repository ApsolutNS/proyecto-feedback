<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard - Supervisi√≥n</title>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- CSS -->
  <link rel="stylesheet" href="css/index.css">
</head>
<body>
  <header>
    <div>
      <h1>Panel Principal - Calidad & Monitoreo</h1>
      <small>Vista ejecutiva + detalle mensual (con filtros por Mes / A√±o / Registrado por)</small>
    </div>
    <div class="header-right">
      <span class="header-user">Usuario: <strong>Supervisor</strong></span>
      <button id="btnTheme" class="btn btn-toggle">‚òÄÔ∏è Modo claro</button>
    </div>
  </header>

  <div class="container">
    <!-- ASIDE -->
    <aside class="left">
      <div class="card">
        <h3>Accesos r√°pidos</h3>
        <button class="btn primary" onclick="location.href='registro.html'">1 ¬∑ Registro</button>
        <button class="btn secondary" onclick="location.href='portal_agente.html'">2 ¬∑ Portal del Agente</button>
        <button class="btn secondary" onclick="location.href='visualizacion_feedback.html'">3 ¬∑ Visualizaci√≥n Feedback</button>
        <button class="btn secondary" onclick="location.href='refuerzos.html'">4 ¬∑ Refuerzos Calidad</button>
        <button class="btn secondary" onclick="window.open('https://monumental-caramel-7369de.netlify.app/', '_blank')">5 ¬∑ Registro de Obervaciones</button>
        <button class="btn secondary" onclick="window.open('https://efectivasa.sharepoint.com/:x:/r/sites/GrupoEFE-EfeCinco/_layouts/15/Doc.aspx?sourcedoc=%7B2A4A6217-A8E9-4912-86F3-370BB45370B0%7D&file=Reporte%20Monitoreo%20Gescob%20-%202025.xlsx&action=default&mobileredirect=true', '_blank')">6 ¬∑ Reporte de monitoreos</button>
        <button class="btn secondary" onclick="window.open('https://docs.google.com/forms/d/e/1FAIpQLSc8s049gfvA-O5nWzlDhIlymceNUnIK-rndWV5aSvhwuDf4TA/viewform?pli=1', '_blank')">7 ¬∑ Ficha de errores</button>
        <button class="btn secondary" onclick="window.open('https://efectivasa.sharepoint.com/sites/GrupoEFE-EfeCinco/Documentos%20compartidos/Forms/AllItems.aspx?id=%2Fsites%2FGrupoEFE%2DEfeCinco%2FDocumentos%20compartidos%2FCalidad%20y%20Formaci%C3%B3n%2FCalidad%2FManual%20de%20Monitoreo%2FManual%20de%20Monitoreo%20v4%2Epdf&parent=%2Fsites%2FGrupoEFE%2DEfeCinco%2FDocumentos%20compartidos%2FCalidad%2FManual%20de%20Monitoreo', '_blank')">8 ¬∑ Manual de calidad</button>
        <button class="btn secondary" onclick="window.open('https://forms.office.com/pages/responsepage.aspx?id=oDcMYc1HMUWfNe-1_TKkEHpWkDIqnlRLmHYcuGRm7NFUM0wxTzg4R0FSMTBSWDlZUzNBUlNQUUIwUi4u', '_blank')">9 ¬∑ Registro de feedback</button>
      </div>

      <!-- KPIs globales simples -->
      <div class="card">
        <h3>Tipo monitoreo (conteo)</h3>
        <p class="small"><b>EFECTIVA:</b> <span id="cntEfectiva">0</span></p>
        <p class="small"><b>EFECTIVANK:</b> <span id="cntEfectivank">0</span></p>
        <p class="small"><b>XPERTO:</b> <span id="cntXperto">0</span></p>
        <p class="small"><b>FACEBOOK:</b> <span id="cntFb">0</span></p>
        <p class="small"><b>INSTAGRAM:</b> <span id="cntIg">0</span></p>
        <p class="small"><b>CORREO:</b> <span id="cntMail">0</span></p>
      </div>
    </aside>

    <!-- MAIN -->
    <main>
      <!-- FILTROS SUPERIORES -->
      <div class="card">
        <h3>Filtros</h3>
        <div class="filters-row">
          <label for="filterMes">Mes:</label>
          <select id="filterMes" class="month-select">
            <option value="">Todos</option>
            <option value="0">Enero</option>
            <option value="1">Febrero</option>
            <option value="2">Marzo</option>
            <option value="3">Abril</option>
            <option value="4">Mayo</option>
            <option value="5">Junio</option>
            <option value="6">Julio</option>
            <option value="7">Agosto</option>
            <option value="8">Septiembre</option>
            <option value="9">Octubre</option>
            <option value="10">Noviembre</option>
            <option value="11">Diciembre</option>
          </select>

          <label for="filterAnio">A√±o:</label>
          <select id="filterAnio" class="year-select">
            <!-- Se llena din√°micamente -->
          </select>

          <label for="filterRegistrado">Registrado por:</label>
          <select id="filterRegistrado">
            <option value="">Todos</option>
            <option value="Alex Paolo Nu√±ez Sulca - L√≠der de Calidad y Formaci√≥n">
              Alex Paolo Nu√±ez Sulca - L√≠der de Calidad y Formaci√≥n
            </option>
            <option value="C√©sar Alonso Torres Montes - Supervisor">
              C√©sar Alonso Torres Montes - Supervisor
            </option>
            <option value="Karen Vanessa Vital Cordova - L√≠der de Operaciones">
              Karen Vanessa Vital Cordova - L√≠der de Operaciones
            </option>
          </select>

          <span class="small" id="filterSummary">Mostrando todos los registros.</span>
        </div>
      </div>

      <!-- VISTA EJECUTIVA POR ASESOR -->
      <div class="card">
        <h3>Vista ejecutiva por asesor
          <span class="tiny-tag">B2 ¬∑ Sem√°foro 85%</span>
        </h3>
        <div class="small">
          Promedio por asesor (c√°lculo completo): promedio, cantidad de feedbacks,
          aprobados (‚â•85), no aprobados (&lt;85), mejor nota y peor nota.  
          Sem√°foro:
          <span class="kpi-green">üü¢ 85‚Äì100</span> /
          <span class="kpi-red">üî¥ 0‚Äì84</span>.
          <br>
          <b>Tip:</b> haz clic en una tarjeta para ver los √≠tems m√°s debitados de ese asesor.
        </div>
        <div id="execGrid" class="exec-grid"></div>
      </div>

      <!-- CARD RANKING DE √çTEMS -->
      <div class="card">
        <h3>Ranking de √≠tems debitados</h3>
        <p class="small">
          Basado en los registros filtrados (Mes / A√±o / Registrado por).  
          Puedes ver el ranking general o por semana, y luego filtrar por asesor desde sus tarjetas.
        </p>
        <button id="btnOpenItemsModal" class="btn secondary">
          üìä Ver ranking general de √≠tems
        </button>
      </div>

      <!-- GR√ÅFICO MES -->
      <div class="card">
        <h3>Promedio semanal</h3>
        <canvas id="chartMonth"></canvas>
      </div>

      <!-- TABLA SEMANAL -->
      <div class="card">
        <h3>Tabla semanal</h3>
        <div class="weekly">
          <table id="weeklyTable">
            <thead id="weeklyHead"></thead>
            <tbody id="weeklyBody"></tbody>
          </table>
        </div>
      </div>

      <!-- √öLTIMOS REGISTROS -->
      <div class="card">
        <h3>√öltimos registros</h3>
        <table id="recentTable">
          <thead>
            <tr>
              <th>Fecha Hora</th>
              <th>Asesor</th>
              <th>Nota</th>
              <th>Tipo</th>
              <th>Registrado por</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </main>
  </div>

  <!-- MODAL √çTEMS DEBITADOS -->
  <div id="itemsModal" class="modal-backdrop">
    <div class="modal-content">
      <div class="modal-header">
        <div>
          <h3 id="itemsModalTitle">√çtems debitados</h3>
          <p id="itemsModalSubtitle" class="small modal-subtitle"></p>
        </div>
        <button id="btnCloseItemsModal" class="modal-close">‚úï</button>
      </div>
      <div class="modal-toolbar">
        <label for="itemsPeriodSelect">Periodo:</label>
        <select id="itemsPeriodSelect"></select>
      </div>
      <div class="modal-body">
        <table class="modal-table">
          <thead>
            <tr>
              <th>√çtem</th>
              <th>Tipo</th>
              <th>Cantidad</th>
              <th>% promedio</th>
              <th>Detalle (ejemplo)</th>
            </tr>
          </thead>
          <tbody id="itemsTableBody">
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- JS principal -->
  <script type="module" src="js/index.js"></script>
</body>
</html>
