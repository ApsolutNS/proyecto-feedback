<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard - Supervisi√≥n</title>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- CSS -->
  <link rel="stylesheet" href="css/index.css">
</head>
<body>
  <header>
    <div>
      <h1>Panel Principal - Calidad & Monitoreo</h1>
      <small>Vista ejecutiva + detalle mensual (filtros: Mes / A√±o / Registrado por)</small>
    </div>

    <div class="header-right">
      <span class="header-user">Usuario: <strong id="userRoleName">Cargando...</strong></span>

      <button id="btnTheme" class="btn btn-toggle">‚òÄÔ∏è Modo claro</button>

      <!-- YA NO TIENE onclick -->
      <button id="btnLogout">Cerrar sesi√≥n</button>
    </div>
  </header>

  <div class="container">
    <!-- ASIDE -->
    <aside class="left">
      <div class="card">
        <h3>Accesos r√°pidos</h3>

        <!-- TODOS SIN INLINE JS -->
        <button class="btn primary" data-nav="registro.html">1 ¬∑ Registro</button>
        <button class="btn secondary" data-nav="portal_agente.html">2 ¬∑ Portal del Agente</button>
        <button class="btn secondary" data-nav="visualizacion_feedback.html">3 ¬∑ Visualizaci√≥n Feedback</button>
        <button class="btn secondary" data-nav="refuerzos.html">4 ¬∑ Refuerzos Calidad</button>

        <button class="btn secondary" data-external="https://monumental-caramel-7369de.netlify.app/">
          5 ¬∑ Registro de Observaciones
        </button>

        <button class="btn secondary" data-external="https://efectivasa.sharepoint.com/:x:/r/sites/GrupoEFE-EfeCinco/_layouts/15/Doc.aspx?sourcedoc=%7B2A4A6217-A8E9-4912-86F3-370BB45370B0%7D&file=Reporte%20Monitoreo%20Gescob%20-%202025.xlsx&action=default&mobileredirect=true">
          6 ¬∑ Reporte de monitoreos
        </button>

        <button class="btn secondary" data-external="https://docs.google.com/forms/d/e/1FAIpQLSc8s049gfvA-O5nWzlDhIlymceNUnIK-rndWV5aSvhwuDf4TA/viewform?pli=1">
          7 ¬∑ Ficha de errores
        </button>

        <button class="btn secondary" data-external="https://efectivasa.sharepoint.com/sites/GrupoEFE-EfeCinco/Documentos%20compartidos/Forms/AllItems.aspx?id=%2Fsites%2FGrupoEFE%2DEfeCinco%2FDocumentos%20compartidos%2FCalidad%20y%20Formaci%C3%B3n%2FCalidad%2FManual%20de%20Monitoreo%2FManual%20de%20Monitoreo%20v4%2Epdf&parent=%2Fsites%2FGrupoEFE%2DEfeCinco%2FDocumentos%20compartidos%2FCalidad%2FManual%20de%20Monitoreo">
          8 ¬∑ Manual de calidad
        </button>

        <button class="btn secondary" data-external="https://forms.office.com/pages/responsepage.aspx?id=oDcMYc1HMUWfNe-1_TKkEHpWkDIqnlRLmHYcuGRm7NFUM0wxTzg4R0FSMTBSWDlZUzNBUlNQUUIwUi4u">
          9 ¬∑ Registro de feedback
        </button>
      </div>

      <!-- KPIs -->
      <div class="card">
        <h3>Tipo monitoreo (conteo)</h3>
        <p class="small"><b>EFECTIVA:</b> <span id="cntEfectiva">0</span></p>
        <p class="small"><b>EFECTIVANK:</b> <span id="cntEfectivank">0</span></p>
        <p class="small"><b>XPERTO:</b> <span id="cntXperto">0</span></p>
        <p class="small"><b>FACEBOOK:</b> <span id="cntFb">0</span></p>
        <p class="small"><b>INSTAGRAM:</b> <span id="cntIg">0</span></p>
        <p class="small"><b>CORREO:</b> <span id="cntMail">0</span></p>
      </div>
    </aside>

    <!-- MAIN -->
    <main>

      <!-- FILTROS -->
      <div class="card">
        <h3>Filtros</h3>
        <div class="filters-row">
          <label for="filterMes">Mes:</label>
          <select id="filterMes" class="month-select">
            <option value="">Todos</option>
            <option value="0">Enero</option>
            <option value="1">Febrero</option>
            <option value="2">Marzo</option>
            <option value="3">Abril</option>
            <option value="4">Mayo</option>
            <option value="5">Junio</option>
            <option value="6">Julio</option>
            <option value="7">Agosto</option>
            <option value="8">Septiembre</option>
            <option value="9">Octubre</option>
            <option value="10">Noviembre</option>
            <option value="11">Diciembre</option>
          </select>

          <label for="filterAnio">A√±o:</label>
          <select id="filterAnio"></select>

          <label for="filterRegistrado">Registrado por:</label>
          <select id="filterRegistrado">
            <option value="">Todos</option>
            <option value="Alex Paolo Nu√±ez Sulca - L√≠der de Calidad y Formaci√≥n">
              Alex Paolo Nu√±ez Sulca - L√≠der de Calidad y Formaci√≥n
            </option>
            <option value="C√©sar Alonso Torres Montes - Supervisor">
              C√©sar Alonso Torres Montes - Supervisor
            </option>
            <option value="Karen Vanessa Vital Cordova - L√≠der de Operaciones">
              Karen Vanessa Vital Cordova - L√≠der de Operaciones
            </option>
          </select>

          <span class="small" id="filterSummary">Mostrando todos los registros.</span>
        </div>
      </div>

      <!-- VISTA EJECUTIVA -->
      <div class="card">
        <h3>Vista ejecutiva por asesor <span class="tiny-tag">B2 ‚Äî Sem√°foro 85%</span></h3>
        <div class="small">
          Promedio, aprobados, desaprobados, mejor y peor nota.  
          Haz clic en una tarjeta para ver los √≠tems debitados del asesor.
        </div>

        <div id="execGrid" class="exec-grid"></div>
      </div>

      <!-- RANKING ITEMS -->
      <div class="card">
        <h3>Ranking de √≠tems debitados</h3>
        <button id="btnOpenItemsModal" class="btn secondary">üìä Ver ranking general</button>
      </div>

      <!-- GRAFICO -->
      <div class="card">
        <h3>Promedio semanal</h3>
        <canvas id="chartMonth"></canvas>
      </div>

      <!-- TABLA -->
      <div class="card">
        <h3>Tabla semanal</h3>
        <div class="weekly">
          <table id="weeklyTable">
            <thead id="weeklyHead"></thead>
            <tbody id="weeklyBody"></tbody>
          </table>
        </div>
      </div>

      <!-- ULTIMOS REGISTROS -->
      <div class="card">
        <h3>√öltimos registros</h3>
        <table id="recentTable">
          <thead>
            <tr>
              <th>Fecha Hora</th>
              <th>Asesor</th>
              <th>Nota</th>
              <th>Tipo</th>
              <th>Registrado por</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </main>
  </div>

  <!-- MODAL ITEMS -->
  <div id="itemsModal" class="modal-backdrop">
    <div class="modal-content">
      <div class="modal-header">
        <div>
          <h3 id="itemsModalTitle">√çtems debitados</h3>
          <p id="itemsModalSubtitle" class="small modal-subtitle"></p>
        </div>
        <button id="btnCloseItemsModal" class="modal-close">‚úï</button>
      </div>

      <div class="modal-toolbar">
        <label>Periodo:</label>
        <select id="itemsPeriodSelect"></select>
      </div>

      <div class="modal-body">
        <table class="modal-table">
          <thead>
            <tr>
              <th>√çtem</th>
              <th>Tipo</th>
              <th>Cantidad</th>
              <th>% promedio</th>
              <th>Detalle</th>
            </tr>
          </thead>
          <tbody id="itemsTableBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- JS PRINCIPAL -->
  <script type="module" src="js/index.js"></script>
</body>
</html>
