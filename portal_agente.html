<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Portal del Agente — Feedback & Refuerzos</title>

    <!-- CSS separado -->
    <link rel="stylesheet" href="css/portal_agente.css">
</head>

<body>

    <!-- DASHBOARD -->
    <div class="card">
        <h2>Portal del Agente</h2>

        <div id="agentStats">
            <div class="statBox">
                <h3>Promedio general</h3>
                <div id="avgScore">–</div>
            </div>

            <div class="statBox">
                <h3>Total feedbacks</h3>
                <div id="totalFb">–</div>
            </div>

            <div class="statBox">
                <h3>Aprobados (≥85%)</h3>
                <div id="okCount">–</div>
            </div>

            <div class="statBox">
                <h3>No aprobados (&lt;85%)</h3>
                <div id="badCount">–</div>
            </div>
        </div>

        <!-- FILTROS -->
        <div class="filters">
            <div>
                <label>Tipo documento</label>
                <select id="selTipoDoc">
                    <option value="registros">Feedback de calidad</option>
                    <option value="refuerzos_calidad">Refuerzos</option>
                </select>
            </div>

            <div>
                <label>Registrado por</label>
                <select id="selRegistrador">
                    <option value="">Todos</option>
                    <option value="Alex Paolo Nuñez Sulca - Líder de Calidad y Formación">Alex Paolo Nuñez Sulca</option>
                    <option value="César Alonso Torres Montes - Supervisor">César Torres</option>
                    <option value="Karen Vanessa Vital Cordova - Líder de Operaciones">Karen Vital</option>
                </select>
            </div>
        </div>

        <!-- TABLA -->
        <table id="agentTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Fecha</th>
                    <th>Detalle</th>
                    <th>Estado</th>
                    <th>Acción</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <p id="pendingBadge"></p>
    </div>

    <!-- DETALLE -->
    <div class="card" id="detailBlock" style="display:none">
        <h3 id="detailTitle">Detalle</h3>
        <div id="feedbackInfo"></div>

        <div id="editableZone">
            <label>Compromiso del agente</label>
            <textarea id="compromiso"></textarea>

            <label>Firma del agente</label>
            <div class="row">
                <button class="btn" id="btnDraw">Dibujar</button>
                <button class="btn ghost" id="btnUpload">Subir</button>
                <input id="fileSignature" type="file" accept="image/*" hidden>
            </div>

            <div id="signaturePreview" class="signature-preview-empty">Sin firma seleccionada</div>

            <button class="btn" id="btnSave">Enviar firma y completar</button>
            <p id="agentMsg"></p>
        </div>
    </div>

    <!-- MODAL FIRMA -->
    <div id="signatureModal" class="modal-backdrop">
        <div class="modal-box">
            <h3>Dibujar firma</h3>
            <canvas id="sigCanvas" width="700" height="160"></canvas>

            <div class="modal-buttons">
                <button class="btn ghost" id="btnClear">Limpiar</button>
                <button class="btn ghost" id="btnCancel">Cancelar</button>
                <button class="btn" id="btnUse">Usar firma</button>
            </div>
        </div>
    </div>

    <!-- JS -->
    <script type="module" src="js/portal_agente.js"></script>
</body>
</html>
